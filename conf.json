{  
    "process_name": "flujo1",
    "hive_database": "pruebas_cuadre",
    "stages": [
        {
            "stage_name": "stage1",
            "inputs": [
                {
                    "source": "EXPERTO_NOMBRES",
                    "destination": "EXPERTO_NOMBRES",
                    "filters":[
                      
                    ]
                },
                {
                    "source": "CDAV_NOMBRES_CANJE",
                    "destination": "CDAV_NOMBRES_CANJE",
                    "filters":[
                        
                    ]
                }
            ],
            "steps":[
                {
                    "inputs": [],
                    "type":"join",
                    "join_type":"FULL OUTER JOIN",
                    "source_table":"EXPERTO_NOMBRES",
                    "destination_table":"CDAV_NOMBRES_CANJE",
                    "join":[
                        {"source": "nrocuenta","destination":"tnum_tarje"},
                        {"source": "fechacomprobanteok","destination":"fec_proc_ok"},
                        {"source": "valorok","destination":"cdav_valor"}
                    ],
                    "outputs":[
                        {
                            "table": "STAGE1_NOMATCH_STEP1",
                            "persist": "TRUE",
                            "filters":[
                                {"expression" : "experto_nombres_nrocuenta is null or cdav_nombres_canje_tnum_tarje is null"}
                            ]
                        },
                        {
                            "table": "STAGE1_MATCH_STEP1",
                            "persist": "TRUE",
                            "filters":[
                                {"expression" : "experto_nombres_nrocuenta is not null and cdav_nombres_canje_tnum_tarje is not null"}
                            ]
                        }
                    ]
                },
                {
                    "inputs": [],
                    "type":"join",
                    "join_type":"FULL OUTER JOIN",
                    "source_table":"EXPERTO_NOMBRES",
                    "destination_table":"CDAV_NOMBRES_CANJE",
                    "join":[
                        {"source": "tarjeta_2","destination":"tarjeta_2"},
                        {"source": "fechacomprobanteok","destination":"fec_proc_ok"},
                        {"source": "valorok","destination":"cdav_valor"}
                    ],
                    "outputs":[
                        {
                            "table": "STAGE1_NOMATCH_STEP2",
                            "persist": "TRUE",
                            "filters":[
                                {"expression" : "experto_nombres_nrocuenta is null or cdav_nombres_canje_tnum_tarje is null"}
                            ]
                        },
                        {
                            "table": "STAGE1_MATCH_STEP2",
                            "persist": "TRUE",
                            "filters":[
                                {"expression" : "experto_nombres_nrocuenta is not null and cdav_nombres_canje_tnum_tarje is not null"}
                            ]
                        }
                    ]
                },
                {
                    "inputs": [],
                    "type":"join",
                    "join_type":"FULL OUTER JOIN",
                    "source_table":"EXPERTO_NOMBRES",
                    "destination_table":"CDAV_NOMBRES_CANJE",
                    "join":[
                        {"source": "nrocuenta","destination":"tnum_tarje"},
                        {"source": "valorok","destination":"cdav_valor"}
                    ],
                    "outputs":[]
                },
                {   
                    "inputs": [],
                    "type":"join",
                    "join_type":"FULL OUTER JOIN",
                    "source_table":"EXPERTO_NOMBRES",
                    "destination_table":"CDAV_NOMBRES_CANJE",
                    "join":[
                        {"source": "nrocuenta","destination":"tnum_tarje"}
                    ],
                    "outputs":[]
                }
            ]
        }
    ]
}


