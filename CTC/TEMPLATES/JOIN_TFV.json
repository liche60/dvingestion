{
    "description": "Cuadre de Cdav, Experto o Experto, Cdav por tajeta reexpedida o amparada, fecha y valor",
    "inputs": [
            {
            "source": "NM_${origen}",
            "destination": "${origen}",
            "filters":[
                {"expression" : "${filtro}"}
            ]
        },
        {
            "source": "NM_${destino}",
            "destination": "${destino}",
            "filters":[]
        }
    ],
    "type":"join",
    "join_type":"FULL OUTER JOIN",
    "source_table":"${origen}",
    "destination_table":"${destino}",
    "join":[
        {"source": "${tarjeta}","destination":"tarjeta"},
        {"source": "fecha","destination":"fecha"},
        {"source": "valor","destination":"valor"}
    ],
    "outputs":[
        {
            "description":"Salida de los que no hacen match, pero solo para experto, esta salida no queda persistida en Memoria",
            "table": "TMP_NM_MEM_EXPERTO",
            "persist": "FALSE",
            "filters":[
                {"expression" : "${origen}_tarjeta is null or ${destino}_tarjeta is null"},
                {"expression" : "${origen}_tarjeta is not null"}
            ]
        },
        {
            "description":"Salida de los que no hacen match, pero solo para cdav, esta salida no queda persistida en Memoria",
            "table": "TMP_NM_MEM_CDAV",
            "persist": "FALSE",
            "filters":[
                {"expression" : "${origen}_tarjeta is null or ${destino}_tarjeta is null"},
                {"expression" : "${destino}_tarjeta is not null"}
            ]
        },
        {
            "description":"Salida general de los que hacen match, esta salida queda persistida en Hive",
            "table": "TMP_M_MEM",
            "persist": "FALSE",
            "filters":[
                {"expression" : "${origen}_tarjeta is not null and ${destino}_tarjeta is not null"}
            ]
        }
    ]
}