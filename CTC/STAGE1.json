{
    "description": "Stage inicial donde solo se toma como insumo la tabla de expertos y cdav",
    "stage_name": "STAGE1",
    "inputs": [],
    "steps":[


        {
            "template_vars":{"source": "${tabla_experto}","tabla":"EXPERTO","filtro":"${columna_experto_fecha} = '${fecha_proceso}'",
                "idconsecutivo":"${columna_experto_id}",
                "tarjeta":"${columna_experto_tarjeta}",
                "fecha":"${columna_experto_fecha}",
                "valor":"${columna_experto_valor}",
                "treexpedida":"${columna_experto_tarjeta_reexpedida}",
                "tamparadora":"${columna_experto_tarjeta_amparadora}"},
            "import":"CTC/TEMPLATES/LOAD_TABLE.json"
        },
        {
            "template_vars":{"source": "${tabla_cdav}","tabla":"CDAV","filtro":"${columna_cdav_fecha} = '${fecha_proceso}'",
                "idconsecutivo":"${columna_cdav_id}",
                "tarjeta":"${columna_cdav_tarjeta}",
                "fecha":"${columna_cdav_fecha}",
                "valor":"${columna_cdav_valor}",
                "treexpedida":"${columna_cdav_tarjeta_reexpedida}",
                "tamparadora":"${columna_cdav_tarjeta_amparadora}"},
            "import":"CTC/TEMPLATES/LOAD_TABLE.json"
        },


        {
            "template_vars":{"tarjeta":"tarjeta","origen":"EXPERTO","destino":"CDAV","filtro":"1 = 1"},
            "import":"CTC/TEMPLATES/JOIN_TFV.json"
        },
        {"import":"CTC/TEMPLATES/NEW_MATCH.json"},
        {
            "template_vars":{"tabla":"EXPERTO"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"CDAV"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },


        {
            "template_vars":{"source": "NM_EXPERTO","tabla":"MEM_EXPERTO","filtro":"treexpedida is null or treexpedida = ''",
                "idconsecutivo":"idconsecutivo",
                "tarjeta":"tarjeta",
                "fecha":"fecha",
                "valor":"valor",
                "treexpedida":"treexpedida",
                "tamparadora":"tamparadora"},
            "import":"CTC/TEMPLATES/LOAD_TABLE.json"
        },
        {
            "template_vars":{"source": "NM_CDAV","tabla":"MEM_CDAV","filtro":"treexpedida is null or treexpedida = ''",
                "idconsecutivo":"idconsecutivo",
                "tarjeta":"tarjeta",
                "fecha":"fecha",
                "valor":"valor",
                "treexpedida":"treexpedida",
                "tamparadora":"tamparadora"},
            "import":"CTC/TEMPLATES/LOAD_TABLE.json"
        },


        {
            "template_vars":{"tarjeta":"treexpedida","origen":"CDAV","destino":"EXPERTO","filtro":"treexpedida is not null and treexpedida <> ''"},
            "import":"CTC/TEMPLATES/JOIN_TFV.json"
        },
        {"import":"CTC/TEMPLATES/APPEND_TO_MATCH.json"},
        {
            "template_vars":{"tabla":"EXPERTO"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"EXPERTO","filtro":"treexpedida is null or treexpedida = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },
        {
            "template_vars":{"tabla":"CDAV"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"CDAV","filtro":"treexpedida is null or treexpedida = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },


        {
            "template_vars":{"tarjeta":"treexpedida","origen":"EXPERTO","destino":"CDAV","filtro":"treexpedida is not null and treexpedida <> ''"},
            "import":"CTC/TEMPLATES/JOIN_TFV.json"
        },
        {"import":"CTC/TEMPLATES/APPEND_TO_MATCH.json"},
        {
            "template_vars":{"tabla":"EXPERTO"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"EXPERTO","filtro":"treexpedida is null or treexpedida = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },
        {
            "template_vars":{"tabla":"CDAV"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"CDAV","filtro":"treexpedida is null or treexpedida = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },


        {
            "template_vars":{"source": "NM_EXPERTO","tabla":"MEM_EXPERTO","filtro":"tamparadora is null or tamparadora = ''",
                "idconsecutivo":"idconsecutivo",
                "tarjeta":"tarjeta",
                "fecha":"fecha",
                "valor":"valor",
                "treexpedida":"treexpedida",
                "tamparadora":"tamparadora"},
            "import":"CTC/TEMPLATES/LOAD_TABLE.json"
        },
        {
            "template_vars":{"source": "NM_CDAV","tabla":"MEM_CDAV","filtro":"tamparadora is null or tamparadora = ''",
                "idconsecutivo":"idconsecutivo",
                "tarjeta":"tarjeta",
                "fecha":"fecha",
                "valor":"valor",
                "treexpedida":"treexpedida",
                "tamparadora":"tamparadora"},
            "import":"CTC/TEMPLATES/LOAD_TABLE.json"
        },


        {
            "template_vars":{"tarjeta":"tamparadora","origen":"CDAV","destino":"EXPERTO","filtro":"tamparadora is not null and tamparadora <> ''"},
            "import":"CTC/TEMPLATES/JOIN_TFV.json"
        },
        {"import":"CTC/TEMPLATES/APPEND_TO_MATCH.json"},
        {
            "template_vars":{"tabla":"EXPERTO"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"EXPERTO","filtro":"tamparadora is null or tamparadora = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },
        {
            "template_vars":{"tabla":"CDAV"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"CDAV","filtro":"tamparadora is null or tamparadora = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },


        {
            "template_vars":{"tarjeta":"tamparadora","origen":"EXPERTO","destino":"CDAV","filtro":"tamparadora is not null and tamparadora <> ''"},
            "import":"CTC/TEMPLATES/JOIN_TFV.json"
        },
        {"import":"CTC/TEMPLATES/APPEND_TO_MATCH.json"},
        {
            "template_vars":{"tabla":"EXPERTO"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"EXPERTO","filtro":"tamparadora is null or tamparadora = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        },
        {
            "template_vars":{"tabla":"CDAV"},
            "import":"CTC/TEMPLATES/NEW_NOMATCH_TABLE.json"
        },
        {
            "template_vars":{"tabla":"CDAV","filtro":"tamparadora is null or tamparadora = ''"},
            "import":"CTC/TEMPLATES/MERGE_TNULL_TO_NM.json"
        }

    ]
}