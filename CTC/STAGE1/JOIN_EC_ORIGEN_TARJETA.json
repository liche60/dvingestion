{
    "description": "Plantilla de cuadre de Experto y Cdav por tajeta, fecha y valor",
    "inputs": [
            {
            "source": "${tabla_experto}",
            "destination": "EXPERTO",
            "filters":[
                {"expression" : "${columna_experto_fecha} = '${fecha_proceso}'"}
            ]
        },
        {
            "source": "${tabla_cdav}",
            "destination": "CDAV",
            "filters":[
                {"expression" : "${columna_cdav_fecha} = '${fecha_proceso}'"}
            ]
        }
    ],
    "type":"join",
    "join_type":"FULL OUTER JOIN",
    "source_table":"EXPERTO",
    "destination_table":"CDAV",
    "join":[
        {"source": "${columna_experto_tarjeta}","destination":"${columna_cdav_tarjeta}"},
        {"source": "${columna_experto_fecha}","destination":"${columna_cdav_fecha}"},
        {"source": "${columna_experto_valor}","destination":"${columna_cdav_valor}"}
    ],
    "outputs":[
        {
            "description":"Salida general de los que hacen match, esta salida queda persistida en Hive",
            "table": "TMP_M_MEM",
            "persist": "FALSE",
            "filters":[
                {"expression" : "EXPERTO_${columna_experto_tarjeta} is not null and CDAV_${columna_cdav_tarjeta} is not null"}
            ]
        },
        {
            "description":"Salida de los que no hacen match, pero solo para experto, esta salida no queda persistida en Memoria",
            "table": "TMP_NM_MEM_EXPERTO",
            "persist": "FALSE",
            "filters":[
                {"expression" : "EXPERTO_${columna_experto_tarjeta} is null or CDAV_${columna_cdav_tarjeta} is null"},
                {"expression" : "EXPERTO_${columna_experto_tarjeta} is not null"}
            ]
        },
        {
            "description":"Salida de los que no hacen match, pero solo para cdav, esta salida no queda persistida en Memoria",
            "table": "TMP_NM_MEM_CDAV",
            "persist": "FALSE",
            "filters":[
                {"expression" : "EXPERTO_${columna_experto_tarjeta} is null or CDAV_${columna_cdav_tarjeta} is null"},
                {"expression" : "CDAV_${columna_cdav_tarjeta} is not null"}
            ]
        }
    ]
}