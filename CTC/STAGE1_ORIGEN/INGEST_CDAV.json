{
    "description":"Merge de la tabla CDAV en memoria con los que no hicieron match",
    "inputs": [
        {
            "source": "${tabla_cdav}",
            "destination": "CDAV",
            "filters":[
                {"expression" : "${columna_cdav_fecha} = '${fecha_proceso}'"}
            ]
        }
    ],
    "type":"merge",
    "destination_columns":[ "idconsecutivo","tarjeta","fecha","valor","treexpedida","tamparadora" ],
    "source_tables":[
        {
            "table": "CDAV",
            "columns": {
                "idconsecutivo":"${columna_cdav_id}",
                "tarjeta":"${columna_cdav_tarjeta}",
                "fecha":"${columna_cdav_fecha}",
                "valor":"${columna_cdav_valor}",
                "treexpedida":"${columna_cdav_tarjeta_reexpedida}",
                "tamparadora":"${columna_cdav_tarjeta_amparadora}"
            }
        }
    ],
    "outputs":[
        {
            "description":"Salida de los que no hacen match en CDAV, esta salida queda persistida en Hive",
            "table": "NM_CDAV",
            "persist": "FALSE",
            "filters":[]
        }
    ]
}