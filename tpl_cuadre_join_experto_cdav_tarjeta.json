{
    "description": "Plantilla de cuadre de Experto y Cdav por tajeta reexpedida, fecha y valor",
    "inputs": [
            {
            "source": "${tabla_experto}",
            "destination": "EXPERTO",
            "filters":[
                {"expression" : "${columna_experto_fecha} = '2017-08-16'"}
            ]
        },
        {
            "source": "${tabla_cdav}",
            "destination": "CDAV",
            "filters":[
                {"expression" : "${columna_cdav_fecha} = '2017-08-16'"}
            ]
        }
    ],
    "type":"join",
    "join_type":"FULL OUTER JOIN",
    "source_table":"EXPERTO",
    "destination_table":"CDAV",
    "join":[
        {"source": "${columna_experto_tarjeta}","destination":"${columna_cdav_tarjeta}"},
        {"source": "${columna_experto_fecha}","destination":"${columna_cdav_fecha}"},
        {"source": "${columna_experto_valor}","destination":"${columna_cdav_valor}"}
    ],
    "outputs":[
        {
            "description":"Salida general de los que no hacen match, esta salida queda persistida en Hive",
            "table": "NM_STAGE1_STEP1",
            "persist": "TRUE",
            "persist_method": "APPEND",
            "filters":[
                {"expression" : "EXPERTO_nrocuenta is null or CDAV_tnum_tarje is null"}
            ]
        },
        {
            "description":"Salida de los que no hacen match, pero solo para experto, esta salida no queda persistida en Memoria",
            "table": "TMP_NM_MEM_EXPERTO",
            "persist": "FALSE",
            "filters":[
                {"expression" : "EXPERTO_nrocuenta is null or CDAV_tnum_tarje is null"},
                {"expression" : "EXPERTO_nrocuenta is not null"}
            ]
        },
        {
            "description":"Salida de los que no hacen match, pero solo para cdav, esta salida no queda persistida en Memoria",
            "table": "TMP_NM_MEM_CDAV",
            "persist": "FALSE",
            "filters":[
                {"expression" : "EXPERTO_nrocuenta is null or CDAV_tnum_tarje is null"},
                {"expression" : "CDAV_tnum_tarje is not null"}
            ]
        },
        {
            "description":"Salida general de los que hacen match, esta salida queda persistida en Hive",
            "table": "M_STAGE1_STEP1",
            "persist": "TRUE",
            "persist_method": "APPEND",
            "filters":[
                {"expression" : "EXPERTO_nrocuenta is not null and CDAV_tnum_tarje is not null"}
            ]
        }
    ]
}